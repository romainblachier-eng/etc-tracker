{{ define "main" }}

{{ $pages := where .Site.RegularPages "Section" "posts" }}
{{ $pages = $pages.ByDate.Reverse }}
{{ $beehiiv := .Site.Params.beehiiv_embed_url }}
{{ $coinzilla := .Site.Params.coinzilla_zone_id }}

<!-- ‚îÄ‚îÄ Hero ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<section class="hero">
  <div class="hero-inner">
    <div class="hero-top">
      <div class="hero-coin">
        <div class="coin-avatar">ETC</div>
        <div>
          <div class="coin-name">Ethereum Classic</div>
          <div class="coin-sub">ETC ¬∑ Proof of Work ¬∑ Mise √† jour quotidienne</div>
        </div>
      </div>

      {{ if $pages }}
        {{ $latest := index $pages 0 }}
        {{ if $latest.Params.price_usd }}
        <div class="hero-price-block">
          <div class="hero-price">${{ printf "%.4f" $latest.Params.price_usd }}</div>
          {{ if $latest.Params.change_24h }}
            {{ if ge $latest.Params.change_24h 0.0 }}
            <div class="price-change up">‚ñ≤ +{{ printf "%.2f" $latest.Params.change_24h }}% sur 24h</div>
            {{ else }}
            <div class="price-change down">‚ñº {{ printf "%.2f" $latest.Params.change_24h }}% sur 24h</div>
            {{ end }}
          {{ end }}
        </div>
        {{ end }}
      {{ end }}
    </div>

    {{ if $pages }}
    {{ $latest := index $pages 0 }}
    {{ if $latest.Params.price_usd }}
    <div class="stat-grid">
      {{ if $latest.Params.price_eur }}
      <div class="stat-card">
        <div class="stat-label">Prix EUR</div>
        <div class="stat-value">‚Ç¨{{ printf "%.4f" $latest.Params.price_eur }}</div>
      </div>
      {{ end }}
      {{ if $latest.Params.change_7d }}
      <div class="stat-card">
        <div class="stat-label">7 jours</div>
        <div class="stat-value {{ if ge $latest.Params.change_7d 0.0 }}positive{{ else }}negative{{ end }}">
          {{ if ge $latest.Params.change_7d 0.0 }}+{{ end }}{{ printf "%.2f" $latest.Params.change_7d }}%
        </div>
      </div>
      {{ end }}
      {{ if $latest.Params.change_30d }}
      <div class="stat-card">
        <div class="stat-label">30 jours</div>
        <div class="stat-value {{ if ge $latest.Params.change_30d 0.0 }}positive{{ else }}negative{{ end }}">
          {{ if ge $latest.Params.change_30d 0.0 }}+{{ end }}{{ printf "%.2f" $latest.Params.change_30d }}%
        </div>
      </div>
      {{ end }}
      {{ if $latest.Params.market_cap }}
      <div class="stat-card">
        <div class="stat-label">Capitalisation</div>
        <div class="stat-value">{{ $latest.Params.market_cap }}</div>
      </div>
      {{ end }}
      {{ if $latest.Params.volume_24h }}
      <div class="stat-card">
        <div class="stat-label">Volume 24h</div>
        <div class="stat-value">{{ $latest.Params.volume_24h }}</div>
      </div>
      {{ end }}
    </div>
    {{ end }}
    {{ end }}
  </div>
</section>

<!-- ‚îÄ‚îÄ Graphique CoinGecko ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  -->
<div style="max-width:940px;margin:0 auto;padding:0 20px;">
  <div class="chart-wrapper">
    <h3>√âvolution du prix ‚Äî 7 derniers jours (live)</h3>
    <script src="https://widgets.coingecko.com/gecko-coin-price-chart-widget.js"></script>
    <gecko-coin-price-chart-widget locale="fr" outlined="false" coin-id="ethereum-classic" initial-currency="usd" width="100%" height="200"></gecko-coin-price-chart-widget>
  </div>

  <!-- Pub banni√®re haute (728x90) -->
  {{ if $coinzilla }}
  <div class="ad-label">Publicit√©</div>
  <div class="ad-wrapper ad-wrapper-top">
    <script async src="//cdn.coinzilla.io/scripts/{{ $coinzilla }}.js"></script>
    <div id="coinzilla_{{ $coinzilla }}"></div>
  </div>
  {{ end }}
</div>

<!-- ‚îÄ‚îÄ Contenu principal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
<main class="page-main">
  <div class="page-inner">

    {{ if $pages }}
      {{ $latest := index $pages 0 }}
      <p class="section-title">Analyse du jour</p>
      <div class="latest-card">
        <span class="latest-badge">Derni√®re mise √† jour</span>
        <h2><a href="{{ $latest.Permalink }}">{{ $latest.Title }}</a></h2>
        <p class="card-meta">{{ $latest.Date.Format "2 January 2006" }}</p>
        <p class="card-excerpt">{{ $latest.Summary }}</p>
        <a href="{{ $latest.Permalink }}" class="btn">Lire l'analyse compl√®te ‚Üí</a>
      </div>

      <!-- ‚îÄ‚îÄ Newsletter Beehiiv ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div class="newsletter-section">
        <h3>üì¨ Recevoir l'analyse ETC chaque matin</h3>
        <p>Abonne-toi gratuitement ‚Äî l'analyse quotidienne directement dans ta bo√Æte mail.</p>
        {{ if $beehiiv }}
          <iframe src="{{ $beehiiv }}"
            class="beehiiv-embed"
            data-test-id="beehiiv-embed"
            frameborder="0" scrolling="no"
            style="width:100%;max-width:480px;height:320px;border-radius:8px;border:1px solid #e5e7eb;background:transparent;">
          </iframe>
        {{ else }}
          <div class="newsletter-placeholder">
            ‚öôÔ∏è Abonnement bient√¥t disponible
          </div>
        {{ end }}
      </div>

      <!-- ‚îÄ‚îÄ Pub milieu de page ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      {{ if $coinzilla }}
      <div class="ad-label">Publicit√©</div>
      <div class="ad-wrapper">
        <script async src="//cdn.coinzilla.io/scripts/{{ $coinzilla }}_2.js"></script>
        <div id="coinzilla_{{ $coinzilla }}_2"></div>
      </div>
      {{ end }}

      <!-- ‚îÄ‚îÄ Archive ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      {{ if gt (len $pages) 1 }}
      <p class="section-title">Historique</p>
      <ul class="archive-list">
        {{ range after 1 $pages }}
        <li class="archive-item">
          <a href="{{ .Permalink }}">{{ .Title }}</a>
          {{ if .Params.change_24h }}
            {{ if ge .Params.change_24h 0.0 }}
            <span class="archive-badge up">+{{ printf "%.2f" .Params.change_24h }}%</span>
            {{ else }}
            <span class="archive-badge down">{{ printf "%.2f" .Params.change_24h }}%</span>
            {{ end }}
          {{ end }}
          <span class="archive-date">{{ .Date.Format "02/01/2006" }}</span>
        </li>
        {{ end }}
      </ul>
      {{ end }}

    {{ else }}
      <div style="text-align:center;padding:60px 20px;">
        <div style="font-size:2.5rem;margin-bottom:16px;">‚è≥</div>
        <h2 style="font-size:1.3rem;font-weight:700;margin-bottom:10px;">Le site se met en place‚Ä¶</h2>
        <p style="color:var(--text-muted);">Le premier article sera g√©n√©r√© lors de la prochaine ex√©cution du workflow GitHub Actions.</p>
      </div>
    {{ end }}

  </div>
</main>

{{ end }}
